<!DOCTYPE html>
<html lang="en">
<head>
	<title>Registration</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->
	<link rel="icon" type="image/png" href="img/icons/favicon.ico"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css" />

	<script>
			function showCollege(str) {
				var dataList = document.getElementById('json-datalist');
  if (str.length==0) { 
    document.getElementById("cn").innerHTML="";
    document.getElementById("cn").style.border="0px";
    return;
  }
  if (window.XMLHttpRequest) {
    // code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
  } else {  // code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  xmlhttp.onreadystatechange=function() {
    if (this.readyState==4 && this.status==200) {
			//remove all the Child before adding it again
			while (dataList.hasChildNodes()) {
    dataList.removeChild(dataList.lastChild);
	}
			var resp  = this.response;
			      var resp = JSON.parse(this.responseText);
			resp.forEach(function(item) {
				var option = document.createElement('option');
        // Set the value using the item in the JSON array.
        option.value = item;
        // Add the <option> element to the <datalist>.
        dataList.appendChild(option);
			})
    }
  }
	var url = "http://register.impulse2k18.cf/college?q=";
	 if(window.location.href.includes(".in"))
	 {
		 url= "http://register.impulse2k18.in/college?q="
	 }
  xmlhttp.open("GET",url+str,true);
  xmlhttp.send();
}
	</script>
<!--===============================================================================================-->
</head>
<body>


	<div class="container-contact100">
		<div class="contact100-map" id="google_map" data-pin="img/icons/map-marker.png" data-scrollwhell="0" data-draggable="1"></div>

		<div class="wrap-contact100">
			<div class="contact100-form-title" style="background-image: url(img/bg-01.jpg);">
				<span class="contact100-form-title-1">
					Register Yourself for {{eventname}}
				</span>

				<span class="contact100-form-title-2">
					Challenge your Pulse! Impulse!
				</span>
			</div>

			<form class="contact100-form validate-form" name="registration" id="reg-form" action="javascript:alert('Umm, Impulse 2K18 is over! Try again Next Impulse?')">
				<input id="eventId" name="eventName" type="hidden" value="{{eventname}}"/>
				<div class="wrap-input100 validate-input" data-validate="Name is required">
					<span class="label-input100">Full Name:</span>
					<input id="name" class="input100" type="text" name="name" placeholder="Enter full name" required>
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate = "Valid email is required: ex@abc.xyz">
					<span class="label-input100">Email:</span>
					<input id="email" class="input100" type="text" name="email" placeholder="Enter email addess" required>
					<span class="focus-input100"></span>
				</div>

				<div class="wrap-input100 validate-input" data-validate="Phone is required">
					<span class="label-input100">Phone:</span>
					<input id="pn" class="input100" type="text" name="phone" placeholder="Enter phone number" required>
					<span class="focus-input100"></span>
				</div>

				<div id="college" class="wrap-input100 validate-input" data-validate = "College name is required">
					<span class="label-input100">College Name:</span>
					<input id="cn"  onkeyup="showCollege(this.value)" list="json-datalist" class="input100 typeahead" name="college_name" placeholder="Give your college name" required></input>
					<span class="focus-input100" ></span>
					<datalist id="json-datalist"></datalist>
				</div>

				<div class="container-contact100-form-btn">
					<button class="contact100-form-btn">
						<span>
							Submit
							<i class="fa fa-long-arrow-right m-l-7" aria-hidden="true"></i>
						</span>
					</button>
				</div>
			</form>
		</div>
	</div>




<!--===============================================================================================-->
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>

<!--===============================================================================================-->
	<script src="vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/daterangepicker/moment.min.js"></script>
	<script src="vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
	<script src="vendor/countdowntime/countdowntime.js"></script>
<!--===============================================================================================-->
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAKFWBqlKAGCeS1rMVoaNlwyayu0e0YRes"></script>
	<script src="js/map-custom.js"></script>
<!--===============================================================================================-->
	<script src="js/mainRegister.js"></script>
	<script src="./js/event_data.js"></script>
<script>
	// var eventnames = {coding: "Coding", it_quiz: "IT Quiz", web_design: "Web Designing", debate: "Debate", et_quiz: "Entertainment Quiz", photography: "Photography", treasure_hunt: "Treasure Hunt", movie_making: "Movie Making", namma_bhaashe_kannada: "Namma Bhaashe Kannada", gaming: "Gaming", footloose: "FootLoose", buzzinga: "Buzzinga"};
	var eventtag = "";
	var events = window.location.href.split("#");
	if (events.length == 2 && (events[1] in eventname_desc))
		eventtag = events[1];
	else
		window.history.back();document.write(eventname_desc[eventtag].name);
	 $("#eventId").val(eventname_desc[eventtag].name);
	localStorage.setItem("eventName", eventname_desc[eventtag].name);
	document.body.innerHTML = document.body.innerHTML.replace("{{eventname}}", eventname_desc[eventtag].name);

//Register
// 	$("#reg-form").submit(function(e) {
//   e.preventDefault();

//   var $form = $(this);
// 		register();
//   $.post($form.attr("action"), $form.serialize()).then(function() {
//     alert("Thank you! Your registration has been recorded");
// 	window.location = 'home.html';
//   });
// });
 function register() {
 	var name =document.getElementById("name").value;
   var eventid = localStorage.getItem("eventName").toString();
   var email = document.getElementById("email").value;
   var pn = document.getElementById("pn").value;
   var cn = document.getElementById("cn").value;
	 console.log(eventid)
	 var xhttp = new XMLHttpRequest();
	 var url = "http://register.impulse2k18.cf/register";
	 var origin = "http://impulse2k18.cf"
	 if(window.location.href.includes(".in"))
	 {
		 url= "http://register.impulse2k18.in/register"
		 origin = "http://impulse2k18.in"
	 }
		 
	 xhttp.open("POST", url, true);
	 console.log(url);
	 xhttp.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
		//Wait for Backend Response
	  console.log(this.responseText);
  	if(this.responseText == "REGISTRATION SUCCESSFUL")
		{
			alert("Thank you! Your Registration has been Recorded!"); 
			window.location = 'home.html';
		}
		else
			alert("Sorry But Something Went Wrong while we tried to register you");
	}
};
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhttp.setRequestHeader("Origin",origin);
  xhttp.setRequestHeader("Access-Control-Allow-Origin","*");
	xhttp.send("name="+name+"&eventName="+eventid+"&email="+email+"&PhoneNumber="+pn+"&collegeName="+cn);
}		
	
</script>

</body>
</html>
